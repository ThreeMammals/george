"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}var SUG={};SUG.App=function(f){var s=f("#su-generator"),o=f("#su-generator-search"),i=f("#su-generator-filter"),e=i.children("a"),u=f("#su-generator-choices"),c=u.find("span"),l=f("#su-generator-settings"),g=f("#su-compatibility-mode-prefix"),a=f("#su-generator-result"),d=f("#su-generator-selected"),p={state:{mceSelection:"",target:"",wpActiveEditor:null,context:"",insertArgs:"",preview:{timer:null,request:null}}};return p.el={body:f("body")},p.init=function(){var a;e.click(function(e){var t=f(this).data("filter");if("all"===t)c.css({opacity:1}).removeClass("su-generator-choice-first");else{var r=new RegExp(t,"gi");c.css({opacity:.2}),c.each(function(){var e;null!==f(this).data("group").match(r)&&f(this).css({opacity:1}).removeClass("su-generator-choice-first")})}e.preventDefault()}),f("#su-generator").on("click",".su-generator-home",function(e){o.val(""),l.html("").hide(),s.removeClass("su-generator-narrow"),i.show(),u.show(),c.show(),p.state.mceSelection="",o.focus(),e.preventDefault()}),f("#su-generator").on("click",".su-generator-close",function(e){f.magnificPopup.close(),e.preventDefault()}),o.on({focus:function e(){f(this).val(""),l.html("").hide(),s.removeClass("su-generator-narrow"),u.show(),c.css({opacity:1}).removeClass("su-generator-choice-first"),i.show()},blur:function e(){},keyup:function e(t){var r=f(".su-generator-choice-first:first"),o=f(this).val(),i=new RegExp(o,"gi"),u=0;13===t.keyCode&&0<r.length&&(t.preventDefault(),f(this).val("").blur(),r.trigger("click")),c.css({opacity:.2}).removeClass("su-generator-choice-first"),c.each(function(){var e=f(this).data(),t=e.shortcode,r,n,a,s=[t,e.name,e.desc,e.group].join(" ").match(i);null!==s&&(f(this).css({opacity:1}),o===t?(c.removeClass("su-generator-choice-first"),f(this).addClass("su-generator-choice-first"),u=999):s.length>u&&(c.removeClass("su-generator-choice-first"),f(this).addClass("su-generator-choice-first"),u=s.length))}),""===o&&c.removeClass("su-generator-choice-first")}}),c.on("click",function(e){var n=f(this).data("shortcode");f.ajax({type:"POST",url:ajaxurl,data:{action:"su_generator_settings",shortcode:n},beforeSend:function e(){f("#su-generator-preview").hide(),u.hide(),l.addClass("su-generator-loading").show(),s.addClass("su-generator-narrow"),i.hide()},success:function e(t){l.removeClass("su-generator-loading"),l.html(t);var r=f("#su-generator-content");void 0!==p.state.mceSelection&&""!==p.state.mceSelection&&"hidden"!==r.attr("type")&&r.val(p.state.mceSelection),f(".su-generator-range-picker").each(function(e){var t,r=f(this).find("input"),n=r.attr("min"),a=r.attr("max"),s=r.attr("step");r.simpleSlider({snap:!0,step:s,range:[n,a]}),r.show(),r.on("keyup blur",function(e){r.simpleSlider("setValue",r.val())})}),f(".su-generator-select-color").each(function(e){f(this).find(".su-generator-select-color-wheel").filter(":first").farbtastic(".su-generator-select-color-value:eq("+e+")"),f(this).find(".su-generator-select-color-value").focus(function(){f(".su-generator-select-color-wheel:eq("+e+")").show()}),f(this).find(".su-generator-select-color-value").blur(function(){f(".su-generator-select-color-wheel:eq("+e+")").hide()})}),f(".su-generator-isp").each(function(){var r=f(this),u=r.find(".su-generator-isp-sources"),n=r.find(".su-generator-isp-source"),e=r.find(".su-generator-isp-add-media"),c=r.find(".su-generator-isp-images"),l=r.find(".su-generator-isp-categories"),g=r.find(".su-generator-isp-taxonomies"),d=f(".su-generator-isp-terms"),p=r.find(".su-generator-attr"),t,a=function e(){var t="none",r="",n=u.val();if("media"===n){var a=[];c.find("span").each(function(e){a[e]=f(this).data("id")}),0<a.length&&(r=a.join(","))}else if("category"===n){var s=l.val()||[];0<s.length&&(r=s.join(","))}else if("taxonomy"===n){var o=g.val()||"",i=d.val()||[];"0"!==o&&0<i.length&&(t="taxonomy: "+o+"/"+i.join(","))}else t="0"===n?"none":n;""!==r&&(t=n+": "+r),p.val(t).trigger("change")};u.on("change",function(e){var t=f(this).val();e.preventDefault(),n.removeClass("su-generator-isp-source-open"),-1===t.indexOf(":")&&r.find(".su-generator-isp-source-"+t).addClass("su-generator-isp-source-open"),a()}),c.on("click","span i",function(){f(this).parent("span").css("border-color","#f03").fadeOut(300,function(){f(this).remove(),a()})}),e.click(function(e){e.preventDefault(),void 0!==t&&t.close(),(t=wp.media.frames.su_media_frame_1=wp.media({title:SUGL10n.isp_media_title,library:{type:"image"},button:{text:SUGL10n.isp_media_insert},multiple:!0})).on("open",function(){f(".mfp-wrap").addClass("hidden")}),t.on("close",function(){f(".mfp-wrap").removeClass("hidden")}),t.on("select",function(){var e=t.state().get("selection").toJSON();c.find("em").remove(),f.each(e,function(e){c.append('<span data-id="'+this.id+'" title="'+this.title+'"><img src="'+this.url+'" alt="" /><i class="sui sui-times"></i></span>')}),a()}).open()}),c.sortable({revert:200,containment:r,tolerance:"pointer",stop:function e(){a()}}),l.on("change",a),d.on("change",a),g.on("change",function(){var r=f(this).parents(".su-generator-isp-source"),e=f(this).val();if(d.hide().find("option").remove(),a(),"0"!==e)var t=f.ajax({url:ajaxurl,type:"post",dataType:"html",data:{action:"su_generator_get_terms",tax:e,class:"su-generator-isp-terms",multiple:!0,size:10},beforeSend:function e(){"object"===_typeof(t)&&t.abort(),d.html("").attr("disabled",!0).hide(),r.addClass("su-generator-loading")},success:function e(t){d.html(t).attr("disabled",!1).show(),r.removeClass("su-generator-loading")}})})}),f(".su-generator-upload-button").each(function(){var e=f(this),t=f(this).parents(".su-generator-attr-container").find("input:text"),r;e.on("click",function(e){e.preventDefault(),e.stopPropagation(),void 0!==r&&r.close(),(r=wp.media.frames.su_media_frame_2=wp.media({title:SUGL10n.upload_title,button:{text:SUGL10n.upload_insert},multiple:!1})).on("select",function(){var e=r.state().get("selection").first().toJSON();t.val(e.url).trigger("change")}),r.on("open",function(){f(".mfp-wrap").addClass("hidden")}),r.on("close",function(){f(".mfp-wrap").removeClass("hidden")}),r.open()})}),f(".su-generator-icon-picker-button").each(function(){var e=f(this),t=f(this).parents(".su-generator-attr-container"),r=t.find(".su-generator-attr"),a=t.find(".su-generator-icon-picker"),s=a.find("input:text");e.click(function(e){a.toggleClass("su-generator-icon-picker-visible"),s.val("").trigger("keyup"),a.hasClass("su-generator-icon-picker-loaded")||(f.ajax({type:"post",url:ajaxurl,data:{action:"su_generator_get_icons"},dataType:"html",beforeSend:function e(){a.addClass("su-generator-loading"),a.addClass("su-generator-icon-picker-loaded")},success:function e(t){a.append(t);var n=a.children("i");n.click(function(e){r.val("icon: "+f(this).attr("title")),a.removeClass("su-generator-icon-picker-visible"),r.trigger("change"),e.preventDefault()}),s.on({keyup:function e(){var t=f(this).val(),r=new RegExp(t,"gi");n.hide(),n.each(function(){var e;null!==f(this).attr("title").match(r)&&f(this).show()})},focus:function e(){f(this).val(""),n.show()}}),a.removeClass("su-generator-loading")}}),e.preventDefault())})}),f(".su-generator-switch").click(function(e){var t,r=f(this).parent().children("input"),n;"yes"===r.val()?r.val("no").trigger("change"):r.val("yes").trigger("change"),e.preventDefault()}),f(".su-generator-switch-value").on("change",function(){var e=f(this),t=e.parent().children(".su-generator-switch"),r=e.val();"yes"===r?t.removeClass("su-generator-switch-no").addClass("su-generator-switch-yes"):"no"===r&&t.removeClass("su-generator-switch-yes").addClass("su-generator-switch-no")}),f("select#su-generator-attr-taxonomy").on("change",function(){var e,t=f(this).val(),r=f("select#su-generator-attr-tax_term");window.su_generator_get_terms=f.ajax({type:"POST",url:ajaxurl,data:{action:"su_generator_get_terms",tax:t,noselect:!0},dataType:"html",beforeSend:function e(){"object"===_typeof(window.su_generator_get_terms)&&window.su_generator_get_terms.abort(),r.parent().addClass("su-generator-loading")},success:function e(t){r.find("option").remove(),r.append(t),r.parent().removeClass("su-generator-loading")}})}),f(".su-generator-shadow-picker").each(function(e){var t=f(this),r=t.find(".su-generator-shadow-picker-field input"),n=t.find(".su-generator-sp-hoff"),a=t.find(".su-generator-sp-voff"),s=t.find(".su-generator-sp-blur"),o={cnt:t.find(".su-generator-shadow-picker-color"),value:t.find(".su-generator-shadow-picker-color-value"),wheel:t.find(".su-generator-shadow-picker-color-wheel")},i=t.find(".su-generator-attr");o.wheel.farbtastic(o.value),o.value.focus(function(){o.wheel.show()}),o.value.blur(function(){o.wheel.hide()}),r.on("change blur keyup",function(){i.val(n.val()+"px "+a.val()+"px "+s.val()+"px "+o.value.val()).trigger("change")}),i.on("keyup",function(){var e=f(this).val().split(" ");4===e.length&&(n.val(e[0].replace("px","")),a.val(e[1].replace("px","")),s.val(e[2].replace("px","")),o.value.val(e[3]),r.trigger("keyup"))})}),f(".su-generator-border-picker").each(function(e){var t=f(this),r=t.find(".su-generator-border-picker-field input, .su-generator-border-picker-field select"),n=t.find(".su-generator-bp-width"),a=t.find(".su-generator-bp-style"),s={cnt:t.find(".su-generator-border-picker-color"),value:t.find(".su-generator-border-picker-color-value"),wheel:t.find(".su-generator-border-picker-color-wheel")},o=t.find(".su-generator-attr");s.wheel.farbtastic(s.value),s.value.focus(function(){s.wheel.show()}),s.value.blur(function(){s.wheel.hide()}),r.on("change blur keyup",function(){o.val(n.val()+"px "+a.val()+" "+s.value.val()).trigger("change")}),o.on("keyup",function(){var e=f(this).val().split(" ");3===e.length&&(n.val(e[0].replace("px","")),a.val(e[1]),s.value.val(e[2]),r.trigger("keyup"))})}),l.find(".su-generator-attr").on("change keyup blur",function(){var e=f(this).parents(".su-generator-attr-container"),t=e.data("default"),r;f(this).val()!=t?e.removeClass("su-generator-skip"):e.addClass("su-generator-skip")}),f(".su-generator-set-value").click(function(e){f(this).parents(".su-generator-attr-container").find("input").val(f(this).text()).trigger("change")}),d.val(n),f.ajax({type:"GET",url:ajaxurl,data:{action:"su_generator_get_preset",id:"last_used",shortcode:n},beforeSend:function e(){},success:function e(t){p.setSettings(t);var r=f("#su-generator-content");void 0!==p.state.mceSelection&&""!==p.state.mceSelection&&"hidden"!==r.attr("type")&&r.val(p.state.mceSelection)},dataType:"json"})},dataType:"html"})}),f("#su-generator").on("click",".su-generator-insert",p.insertShortcode),f("#su-generator").on("click",".su-generator-toggle-preview",function(e){var t=f("#su-generator-preview"),r;f(this).hide(),t.addClass("su-generator-loading").show(),l.find("input, textarea, select").on("change keyup blur",function(){p.updatePreview()}),p.updatePreview(!0),e.preventDefault()}),f("#su-generator").on("mouseenter click",".su-generator-presets",function(){clearTimeout(a),f(".su-gp-popup").show()}),f("#su-generator").on("mouseleave",".su-generator-presets",function(){a=window.setTimeout(function(){f(".su-gp-popup").fadeOut(200)},600)}),f("#su-generator").on("click",".su-gp-new",function(e){var t=f(this).parents(".su-generator-presets"),r=f(".su-gp-list"),n=(new Date).getTime(),a=prompt(SUGL10n.presets_prompt_msg,SUGL10n.presets_prompt_value);""!==a&&null!==a&&(r.find("b").hide(),r.append('<span data-id="'+n+'"><em>'+a+'</em><i class="sui sui-times"></i></span>'),p.addPreset(n,a))}),f("#su-generator").on("click",".su-gp-list span",function(e){var t=f(".su-generator-presets").data("shortcode"),r=f(this).data("id"),n=f(".su-generator-insert");f(".su-gp-popup").hide(),clearTimeout(a),f.ajax({type:"GET",url:ajaxurl,data:{action:"su_generator_get_preset",id:r,shortcode:t},beforeSend:function e(){n.addClass("button-primary-disabled").attr("disabled",!0)},success:function e(t){n.removeClass("button-primary-disabled").attr("disabled",!1),p.setSettings(t)},dataType:"json"}),e.preventDefault(),e.stopPropagation()}),f("#su-generator").on("click",".su-gp-list i",function(e){var t=f(this).parents(".su-gp-list"),r=f(this).parent("span"),n=r.data("id");r.remove(),t.find("span").length<1&&t.find("b").show(),p.removePreset(n),e.stopPropagation(),e.preventDefault()})},p.addPreset=function(e,t){var r=f(".su-generator-presets").data("shortcode"),n=p.getSettings();f.ajax({type:"POST",url:ajaxurl,data:{action:"su_generator_add_preset",id:e,name:t,shortcode:r,settings:n}})},p.removePreset=function(e){var t=f(".su-generator-presets").data("shortcode");f.ajax({type:"POST",url:ajaxurl,data:{action:"su_generator_remove_preset",id:e,shortcode:t}})},p.parseSettings=function(){var e=d.val(),t=g.val(),r=f("#su-generator-settings .su-generator-attr-container:not(.su-generator-skip) .su-generator-attr"),n=f("textarea#su-generator-content"),a=n.length?n.val():"false",s=new String("");return s+="["+t+e,r.each(function(){var e=f(this),t="";null==(t=e.is("select")?e.find("option:selected").val():e.val())?t="":"array"==typeof t&&(t=t.join(",")),""!==t&&(s+=" "+f(this).attr("name")+'="'+f(this).val().toString().replace(/"/gi,"'")+'"')}),s+="]","false"!=a&&(s+=a+"[/"+t+e+"]"),s},p.getSettings=function(){var e=d.val(),t=f("#su-generator-settings .su-generator-attr"),r=f("textarea#su-generator-content"),n=r.length?r.val():"false",a={};return t.each(function(e){var t=f(this),r="",n=t.attr("name");null==(r=t.is("select")?t.find("option:selected").val():t.val())&&(r=""),a[n]=r}),a.content=n.toString(),a},p.setSettings=function(r){var e=f("#su-generator-settings .su-generator-attr"),t=f("#su-generator-content");e.each(function(){var e=f(this),t=e.attr("name");r.hasOwnProperty(t)&&(e.val(r[t]),e.trigger("keyup").trigger("change").trigger("blur"))}),r.hasOwnProperty("content")&&t.val(r.content).trigger("keyup").trigger("change").trigger("blur"),p.updatePreview()},p.updatePreview=function(e){var r=f("#su-generator-preview"),t=p.parseSettings(),n=a.text();e=e||!1,r.is(":visible")&&(t!==n||e)&&(window.clearTimeout(p.state.preview.timer),p.state.preview.timer=window.setTimeout(function(){p.state.preview.request=f.ajax({type:"POST",url:ajaxurl,cache:!1,data:{action:"su_generator_preview",shortcode:t},beforeSend:function e(){p.state.preview.request&&p.state.preview.request.abort(),r.addClass("su-generator-loading").html("")},success:function e(t){r.html(t).removeClass("su-generator-loading")},dataType:"html"})},300),a.text(t))},p.insert=function(e,t){if("string"==typeof e&&"object"===_typeof(t)){p.state.context=e;var r=(p.state.insertArgs=t).shortcode||"",n={type:"inline",alignTop:!0,items:{src:"#su-generator"},callbacks:{}};n.callbacks.open=function(){r?c.filter('[data-shortcode="'.concat(r,'"]')).trigger("click"):window.setTimeout(function(){return o.focus()},200),p.el.body.addClass("su-mfp-shown"),"undefined"!=typeof tinyMCE&&null!=tinyMCE.activeEditor&&tinyMCE.activeEditor.hasOwnProperty("selection")&&(p.state.mceSelection=tinyMCE.activeEditor.selection.getContent({format:"text"}))},n.callbacks.close=function(){o.val(""),l.html("").hide(),s.removeClass("su-generator-narrow"),i.show(),u.show(),c.show(),p.state.mceSelection="",p.el.body.removeClass("su-mfp-shown")},f.magnificPopup.open(n)}},p.insertShortcode=function(){var e=p.parseSettings();if(p.addPreset("last_used",SUGL10n.last_used),f.magnificPopup.close(),a.text(e),"classic"===p.state.context)p.state.wpActiveEditor=window.wpActiveEditor,window.wpActiveEditor=p.state.insertArgs.editorID,window.wp.media.editor.insert(e),window.wpActiveEditor=p.state.wpActiveEditor;else if("block"===p.state.context){var t=p.state.insertArgs.props;if(t.attributes.hasOwnProperty("content"))t.setAttributes({content:t.attributes.content+e});else if("core/shortcode"===t.name){var r=t.attributes.hasOwnProperty("text")?t.attributes.text:"";t.setAttributes({text:r+e})}}},p.insertAtCaret=function(e,t){var r=e.selectionStart,n=e.selectionEnd;e.value=e.value.substring(0,r)+t+e.value.substring(r),e.focus(),e.selectionStart=r+t.length},{init:p.init,insert:p.insert}}(jQuery),jQuery(document).ready(SUG.App.init);
//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map